#!/usr/bin/env python

import logging
info = logging.info

def find_clumps(S, k, L, t):
    '''
    >>> find_clumps('CGGACTCGACAGATGTGAAGAACGACAATGTGAAGACTCGACACGACAGAGTGAAGAGAAGAGGAAACATTGTAA', 5, 50, 4)
    ('CGACA', 'GAAGA')
    '''

    from count_k_mers import count_k_mers

    i = 0
    cs = set()
    old_perc = new_perc = 0
    i_last = len(S) - L
    while i <= i_last:
        for clump in count_k_mers(S[i:i+L], k, t):
            cs.add(clump)
        new_perc = float(i) / i_last * 100
        if new_perc - old_perc >= 0.1:
            info('%.1f%%' % new_perc)
            old_perc = new_perc
        i += 1
    return tuple(cs)


if __name__ == '__main__':
    # import doctest
    # doctest.testmod()
    logging.basicConfig(format='%(message)s', level=logging.INFO)
    genome = open('/home/xio/Desktop/E-coli.txt', 'r').read().strip()
    print len(find_clumps(genome, 9, 900, 3))
    # S = 'TGCTGCTAGCATGCCACTCTTCTATAACGGTACGCCCAACCAATAAAATTTATCCGATAGCCAAGACACGTTCTTCAGGTTTATGTTACTGGTGCCGTTTTTATCCGATCTACGACTGGTCCTGAAGGGTGGATGAATCATTTACTATAGGTAGTTCACAGCACGGTGTACCGTTAATCAGGCTGTTAGCTCATGTACCATGGTGATCGCCCTATTGAGTCCTATACCATACGTAAAGGATGTTCCCTCACAGGGGGGCATACAAGGTAAGCAGCGCTATGAGACTCTTGTCCGTACAATGGGGGCCGGCTTTTTACCCGAATATTGCGCGATTAATCTTCATTGTCGAAACTCAATATGAACACGATTACTGGAATCGTCGGCTTGGGATCGGCAGCTCGTTAACACCGGATCGAACTTCGTAATATGGTGCCTGGGTAACTGTCAAAGCCTTTCTTGTCCTCTATCGATGGACAAGCAGTGCAACCGGGAATAATTTCTTAAAGTGTACGCAGATCTATCATTCCGAAGAACGCGTTGCGAGAGAGGGCCGTCGGAGCTTTCAAACCATTCTATTACAGTTGAATTGAAGATAACGATTTATGAGTAGGTAACCTTTAAGACCGATCCTGCAATCTCATTTTAAATGCGATGTCCACATACAGTTATAGGTTTCTCTCAGCACCGGTTCTCGACCGTGCCACTGCCAATAGAGACAATTGACCCCCCGGCCGCTAAACATTCGAGTCGAGTGGTATGCGTAATATCAGTACGTAAATGTACCATCCGACGGTTCAGTCGCTCCTAGATGTTAAGTTGATCAGGCAAGCTCTCTCGTAGTGTCTTCAGAGGCAAGAGACGATCACCTAAGTATCACAATAGAATGCATGGTTGCAATCGGAATTTCCGCAGTGAGGACCCCAAGAGCTATGGATGATCACTTAGTGTGAATATAAAAATAAACAATTATCTGTTCCCGTCCCTTGCATCTGGGCGGGGACTGCAACCTAACACACCGATGTCGCGTTATTCGATATGCTACAACAGGTTATTCACTCTAACGCGGGTCGATCTGTGCACATAATTAAGTATAAGGTACCGCACGTCCAGTACATTACATCTCGCCTTAGCCGAAGCTCCCCTCCAACCGACGGAGTGCCAACGTATGCACCTCTAAGTACTGACTGGCGTCGACCGCCACGGACAACCCGAGGGTCAATATCGTCTCCAATGAACGTAGACAGTCGCTTCATCATGGTCCTCGGGTGCCGCCCAGGTTTCTTCGTTGGCTCGTCTAATGCGTTGTACGCCACTACCAGGTAGAGTGTTGTTTGGACCCACTTTACTGAAAAGGCAACCGTACGTGGTTTGATCCCGGTATACTCCGGTATCTTGGATGATGTCCAGCCGCCGGTGCCATCCCGTATATTAGTAAGCTGGGGTGCAGAACCCTGGCCATGTGGTATGCGGATGGGAACCCGTAAACGTGGGTATAGCCAGCCACGCTTTCACCCTATTAAAATGGCTCTTCCCCTGAATGCCAGTTGTGAAGGGCGGATAGCGACTGTCCGGACGATCACGATTAATAGGCAGACTCTGTTCAATTCGCAGAGGGGGATCTTTTTGGATGATTGTCGTCGGTGCGACTGTCCAAACCCGCGCCGTGTGGCGATGCGAGGCGACTACAATATGAGGCAACAGGGACTTCGCTTCCGGTATACGCATGGTACACATCCCGACTTCTCGCAGCTTCGGTACACATCGATCTGGGCGGTAGCTCCTACGGGCATCTCCTAGTAGGCAATGATCGCGATCGAGAACTGGTAACACAATATCCCAGTGTTGCTTCGTAGCCAAGTTCAATGCTATAGAGATTGTTAAACCACGGGGTTGCAATCCATTCTGGACGGTATCCTGAGTAACCTTAACTGTTTTGACTGTACCCAGTGTGAGCGTAGGGAAATCATTTTGGATCCTACGGGCGGGAGGCCGAATAGGGGTCTAGTATTGTGTGCGTGCCTGGAGCTTGCCGCCCACATCAATAGCTAGCTGTTCTCCCGAGCGAACTCGCCACTGAGGAACGACGGATGATGGGTACTGGATAGGCGTTTACATTTTCAAACGCACAAACCGGGACCATTCGCCTGAAGTCCGACAGGGTGGTGGGTTCATTGCACTCGGCGCATTTAAACTGCCCTCACCATGCTCTCGGATACTATAAATAGAGCATCGGCCCGAAGGTTTCCGACTTCGCAGGCACCCGACCAATATACACCAGAATTGCTCCTGTTGACCTTTGTATTTCTGATATAGTTCTTAAAAATGGCAGTTCTGATCCAGGGAATCCTCTTTCTGGAATAAACAGCCCCGGGGTCGAAATTTCGGTCGACCTCGCCAATTAGCCCTAGCTCGGTTTGACAGGGTCTGACATATAGTGCGTCCAGCTTCCGTATCGACCTTTTACGAATAATGGCTATCCTGGAGACAATAAATCAACTTATGACCCCTTACTGCCTAGCACCCAGAGGACTCAAAGAATCAGATACAGCGAGGGCAACCTATACCACAAACTGCCCAATATGCGTGGCCTCAGCTTGACCAAACTCTAGCACAGCAAAGTTCCTGCGCTTCCGAAGGCGGCATGCATACCGGAGTTATCCTTGTCGGTTATTACTTACCCCGTTCGCTCGTGAACAGTTCGGAGGGTCTCCTCCGGCCCCGGCGTATTATCACCGGTGTGTCGGTTATTGACGTTTCTTGTCGGTTATTAGTCCAGCGGCAGTGTCGGTTATTTTGGGTGTCGGTTATTGACACGGTGTCGGTTATTAAGCACCTCGTCTGTCGGTTATTTATTTGGTATATGAGTACACAGTTGTCTGTCGGTTATTATAATGTCGGTTATTGCCGCGCAATATAGCAAGTCTGGCGCCGATGTCGGTTATTTTCACTACGGGTGTCGGTTATTATAAACTGTCGGTTATTCTGAATTGTCGGTTATTTCTGTCGGTTATTTTGTCGGTTATTTTTTGATATCTCTGTCGGTTATTCAGGTAACATTGGTGTCGGTTATTGGTGTCGTGTCGGTTATTCGTTCCCATCTGCTGTGTCATGTCGGTTATTATTGTCGGTTATTAGCGTGTCGGTTATTAGCCTGACAATTTGTCGGTTATTCTTGTCGGTTATGTCGGTTATTTGCTGCTCCTGATTGATTCTCGGCTTCGTTTCTTGCGGGCGTTACATGTCGGTTATTACCTTACGCGGATAGCGATCCTAACATCCTGAAACGACCCGTGCTGAATCTCATCGCACGCCAGCGGGTTACAATGTAGCTCTCTCTTATTTGGTGCCACCGAAAGTCATGACCCACGTCGTCGGATCCGGCCGTTAGACCGTATCATGAAGATTCAGAACTTAGCAATTCGATCGTATCGTGATTATGCGACCAACCAGCGTTTGCGAGGCCCCGCCGGCCTGAAGATGTCCATACTCCGATATCGCTGGAACCTGCCATAGTTATCCCGGATGACTGCTTGGGGCAGGCAAGCTCATGACCACGGCCGGACCGGCCCCTCAGACATGAGTAAAAAGCCGGCACTGTAGAATAACCTCACAACTCTGCGGGCCTACTCCGCGAAAAATAAGCTTACGCTACCTAGAAAACAACTTGACAGTTGATGCCCGAAATGTCCATCTAATCGATGTGGGTCCATGCGCCACCTCCAGTCCGGTTGAAATAAATGCCTTCCGCCAACTCAGGGTACGTCTTCCGTTTAAACTGGACCTCGGCAAAAAAAAACGCTTCAATCAAGCAGTTTTGTACGGCGGCATGATCTATTCTTTCGCCCTCCCGTCCGATTAGGTCGAGAGACATATGGTCAGAGAGAACCAGGTGGTGCAAAGGAGTCGTGATCGTGCAGAGCTTACGGTGGGAGTTATATTAGTCCGTGCAACGCTTCCATATCTAATTGTGAGTTCTCGTCCGGATTAGAGAACCACGCAAGAAATTAGTCGTGGCAACTTTAAGACCGATGGATACACCACAGGGACGTATTCGCATAGGCTGTGCTATCCAATCCCCGTGGCATGTAACTGTTTTGAGTAGATGTGCCCTTTTAAGACGAGAGATGGGTCATTGACGTCTCTATTACCCTTTCTCGGTATGGGCTGGGCACTCTGAAATCAGCATATAGGTGCGAGGGGCATAGTACATTAAATCAATAAGGAAGTATATGAATCTCCTGAGCTGCTAACTAGAGTAGAGTAACTAGAGCTGCTAACTAGAGAAAGACCAAACCACGCGGTATTGCTAACTAGAGGGCTAACGCTAACTAGAGTGACCGACGACTACATTTCGGAGAGCTAACTAGAGTACGAGAGAACTGCTAACTATCATCGACTATCATCGTAGAGTTCTATCATCGGGCTAACTAGAGGAACCTATCATCGTAACTAGCTATCATCCTATCATCGATCGAAGAAGCAGAATGCCGGAACCAAGCCCTATCATCGTCTATCATCGTCTCTCTATCATCGCGTTGAAAGCTAACTAGAGCGATCTAACAAGGTGTAACGTCTTCCCGTCTGACTATCATCGAACTAGAGCTAGAGCTTCGGCCGAAGTCGTTAGGCTCTGCTCACTCTATCGCCGCTCACTCGCTCACTCGCTCACTCTATGCTCACTCTAATCGCGCTATCGCTCACTCTACGTTGGCTATCATCGATCATCGTCTATCATGCTCACTCTAAGAGATCGACCAGCTCACTCTATCATCGTGCTCACTCTATGATGCCTAGCTCACTCTATCATCGCCGCATGCCTAATGCGGATGCGGTTTGCTCACTCTATCATCGACCTATCATCGCTGGGAGATCTCCATACTATCATCGGCACGCTCACTCTATCTAGCTCACTCTATCGCGCTCACTCTATGCTCACTCTACTCTATACCGCTCACTCTACTGCTCACTCTAAAGCTCACTCTAGCGGCGCTCACTCTACTCACTCTATCGATGCTCACTCTACACTCTACGTTTCCACGTTATGTCCAGACTGCTCACTCTACCGACTTGTATAGTGGCTCCAGGCATCCAGACTACTAGCTCACTCTATATGCGTGGGTTTGTACGGGTTTGTACATGGCGGGGCTCACTCTAGTAGCTCACTGCTCACTCTACTAGACTTCGTCCAGACTGATTGAGCGTCGCCTAAGTCCAGACTTCCAGACTCGTCCAGACTCTCGCGGGCTCGCCCCTGACTACCTGGGGTTTGTAGACTAACGGGGCCTCCAGTCCAGACTACTAGGACCTATCCAGATCCAGACTCCCTTATAATCCAGACTTGAGGGGGTTTGTAGTTTGTAGCTCCTTACACAGTATGGGTTTGTAGGTTTGTAGGGTTTGTAGAGGGTTTGTAGGGGGTTTGTATTCTTAGGGTTTGTAGGGGTTTGTATACCGTTCCAGACTGAGGGTTTGTATTTGTACGGTTCACGGCTAGGGTTTGTACTTTCGATATTCGTCGGGTTTGTATTCGACATCTTCGGAGCTGCGTCAAGGGGGGTTTGTATGTGGGTTTGTATCTCTCCTAGTTGAACATCCCGCTTTATCTCCGCCGGGTTTGTACGCCCTGGGTTTGTATTGTGGGTTTGTACGGCACCATAAACGGGTTTGTATATAAACGGCACTGTTGAAACCTAAACGGCACGGCACTAGTGCGTTTGAGTTGTGTAAACGGACATTCCCAGACTTAAACGGCACACCACTGTTTAAACGGTAAACGGCACGCCCCGGTTACGTTCGACTCAATAACAAGGGGGAATAAACGGCACAAACGGCACCACTTATTACGCGAACTAAACGGCACGTGAGTCTTGGAGGTAAACGGCACACTACATCCGCATTAAACGGCACTATGGGCAGTTAAGCTAAACGGCACTCGCGTACGGCACATTGATAAACGGCACCCGAGCAAGGAATGGTGAATTTGTCCACCGAGGCACTCGTTCCATTTAAATTTGCAGCGGACGTTTTGCAGCGGAAACGGCACCGGTTTTTTGCAGCGGACACCCCTTGGCAGAGGTAAACGGCATTTGTTTGCAGCGGTTGCAGCGGAACGGCACATTTGCAGCGGAAACGTTTGCAGCGTTTGCAGCGGTTGCAGCGGAGCGGTTGATGTCGATTGTTGCCCTTTGCAGCGGTTTGCAGCGGATCTTTGCAGCGGGTAGGCCATCGTGTCTTTGCAGCGGGGGTATGTTTTGCAGCGGGTTTGCAGTTTGCAGCGGAAATACCACGGATATAGATTTTGCAGCGGCGTTTGCAGCGGCGATTTGCAGCGGCTTTTGCAGCGGGTTTGCAGCGGCTCAGTTTTTAAAAAATTTTTTGCAGCGGGGTGTGAGCCCCGATCGTTGACGCGAGTGTTTGCAGCGGACAGGTATTTCGGAACCGTTTGCAGCGGGGCTGATGGTTTTGCAGCGGCAACGTTGCGAGAAGTTTGCAGCGGCGAGCGCGTCTTTGCTGAAGAAACGACTCGCCCCCGCCCCCGTTACGTTCTTTTTTACTACGAAACGTTCCGCTATGGCTGCATGATTAACCGGCAGGCCCTTCGGCGCGAGAGAATTGTTAAGTTGAATGACACATTTATATGGAAGCCGGGGTCGCATCTGACTCTTTCTAGTAAATCTATCTGTAGCCCGCTCCCCAGGAGTTCCTAGGGTTGCACGGAGCGGCGGATCAGTCACCGACGAGAGTATCGCCGTTCAGAAGTTTAGTCGAAAAGGCGTTAAGTTCAACCGAATGAATAACCCGCGCGCAGGCTCGTTTAATTGCATTACTCGAAGGATGGTTGGACACTTGATGCCTATACGACAGAAAGTACCGAGGACCTTGAACGTTCTTTCAGAGCCGCGCGGGGTCTGCGAAATGCTTTACGGCCAGATGGAGGAGGCCCTACAGCCGCGATACAAAACGCGGGATTCCTACGAAACCTGAATACCAGGCGCCAGATTCTTGAAGTACATGGAACTGCGTATGATCGTGGATCAAAGTCACCTGCGTATGACTAGAGTGCCTCTGCGTATGAATGCGACGGCTTTATTTTAGGGCTGCGTATGAGTACTGCGTATGAACGTATGAAGTGATTCTGCCTGCGTATGAGTCTGCGTATGAACGGAGCCTAGTTATCGTTTCCTAGACTCGGCGACGGGGGACCTTTATAGATAGGACAGACAGGAAGCTTTGCTGCGTATGACTTTGTCGCTTTGTCGCTTTGTCGCTTTGTCGCTTTGTCGCTTTGTCCTGCTGCGTATGACGCTTCTGCGTATGATGCGTATGACTTTGTCGCTGCGTATGAATCCTGCGTATGCTGCGTATGATCCTGCGTATGATTGCTGCGTATGACTGCGTATGATGTTTGAAGTTTAGCGTATGATTGAAGTTTAGCTAGCCGTTGAAGTTTAGCCTGTGAAGTTTAGCCTTTGTCGCTTTGTCGCTTTGAAGTTTAGCCGTTTCCTGCGTATGAGTGAAGTTTAGCAGTTTAGCTGATTTCCTGAAGTTTAGCCAAGTTTCCGCAAGTTTTGTGAAGTTTAGCCAAGTTTCCGCAAGTCTGAAGTTTAGCCGCAAGTGAAGTTTAGCTTCCGCAAGTTTCCGCAAGTTTCCGCAAGTTTCCGCAAGTTTGAAGTTTAGCTTTAGCGTTTCCGCAAGTTTCCGCAAGTTTCCGCAAGTTTTGAAGTTTAGCAGTTTTGAAGTTTAGCAGTTTAGCAGTTTCCGCAAGTGTGAAGTTTAGCCCTGAAGTTTAGCCAAGTTTCCGCAAGGCACGATCATTCCGCAAGTTTCTGAAGTTTAGCTGTGAAGTTTGAAGTTTAGCACGATCACACGATGAAGTTGAAGTTTAGCAGCACGAGCACGATCAATATTTGAAGTGAAGTTGAAGTTTAGCAATATTGACCAATATGCACGATCAGACCAATATTGGCACGATCACCAATATTGACCTGAAGTTTAGCATTGGCACGATCACCAATATTGACCAATATTGACCAGCACGATCAATCACCAATATTGACCAATATGCACGATCAGACCAATAGCACGATCATGACCAATAGCACGATCAACCAATATTGCACGATCAAGCACGATCACAATATTGACCAATATTGACGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCGCACGATCAGATCAGCACGATCA'
    # print find_clumps(S, 11, 544, 18)
