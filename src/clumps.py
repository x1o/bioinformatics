#!/usr/bin/env python

from count_k_mers import count_k_mers
import sys

def find_clumps(S, k, L, t):
    '''
    >>> find_clumps('CGGACTCGACAGATGTGAAGAACGACAATGTGAAGACTCGACACGACAGAGTGAAGAGAAGAGGAAACATTGTAA', 5, 50, 4)
    ('CGACA', 'GAAGA')
    '''

    i = 0
    cs = set()
    i_last = len(S) - L
    while i <= i_last:
        for clump in count_k_mers(S[i:i+L], k, t):
            cs.add(clump)
        # sys.stdout.write('\r%d / %d' % (i, i_last))
        sys.stdout.write('\r%.1f%%' % (float(i) / i_last * 100))
        # sys.stdout.flush()
        i += 1
    print
    return tuple(cs)

if __name__ == '__main__':
    # import doctest
    # doctest.testmod()
    # genome = open('../dna/E-coli.txt', 'r').read().strip()
    # print len(find_clumps(genome, 9, 500, 3))
    S = 'TGCTGCTAGCATGCCACTCTTCTATAACGGTACGCCCAACCAATAAAATTTATCCGATAGCCAAGACACGTTCTTCAGGTTTATGTTACTGGTGCCGTTTTTATCCGATCTACGACTGGTCCTGAAGGGTGGATGAATCATTTACTATAGGTAGTTCACAGCACGGTGTACCGTTAATCAGGCTGTTAGCTCATGTACCATGGTGATCGCCCTATTGAGTCCTATACCATACGTAAAGGATGTTCCCTCACAGGGGGGCATACAAGGTAAGCAGCGCTATGAGACTCTTGTCCGTACAATGGGGGCCGGCTTTTTACCCGAATATTGCGCGATTAATCTTCATTGTCGAAACTCAATATGAACACGATTACTGGAATCGTCGGCTTGGGATCGGCAGCTCGTTAACACCGGATCGAACTTCGTAATATGGTGCCTGGGTAACTGTCAAAGCCTTTCTTGTCCTCTATCGATGGACAAGCAGTGCAACCGGGAATAATTTCTTAAAGTGTACGCAGATCTATCATTCCGAAGAACGCGTTGCGAGAGAGGGCCGTCGGAGCTTTCAAACCATTCTATTACAGTTGAATTGAAGATAACGATTTATGAGTAGGTAACCTTTAAGACCGATCCTGCAATCTCATTTTAAATGCGATGTCCACATACAGTTATAGGTTTCTCTCAGCACCGGTTCTCGACCGTGCCACTGCCAATAGAGACAATTGACCCCCCGGCCGCTAAACATTCGAGTCGAGTGGTATGCGTAATATCAGTACGTAAATGTACCATCCGACGGTTCAGTCGCTCCTAGATGTTAAGTTGATCAGGCAAGCTCTCTCGTAGTGTCTTCAGAGGCAAGAGACGATCACCTAAGTATCACAATAGAATGCATGGTTGCAATCGGAATTTCCGCAGTGAGGACCCCAAGAGCTATGGATGATCACTTAGTGTGAATATAAAAATAAACAATTATCTGTTCCCGTCCCTTGCATCTGGGCGGGGACTGCAACCTAACACACCGATGTCGCGTTATTCGATATGCTACAACAGGTTATTCACTCTAACGCGGGTCGATCTGTGCACATAATTAAGTATAAGGTACCGCACGTCCAGTACATTACATCTCGCCTTAGCCGAAGCTCCCCTCCAACCGACGGAGTGCCAACGTATGCACCTCTAAGTACTGACTGGCGTCGACCGCCACGGACAACCCGAGGGTCAATATCGTCTCCAATGAACGTAGACAGTCGCTTCATCATGGTCCTCGGGTGCCGCCCAGGTTTCTTCGTTGGCTCGTCTAATGCGTTGTACGCCACTACCAGGTAGAGTGTTGTTTGGACCCACTTTACTGAAAAGGCAACCGTACGTGGTTTGATCCCGGTATACTCCGGTATCTTGGATGATGTCCAGCCGCCGGTGCCATCCCGTATATTAGTAAGCTGGGGTGCAGAACCCTGGCCATGTGGTATGCGGATGGGAACCCGTAAACGTGGGTATAGCCAGCCACGCTTTCACCCTATTAAAATGGCTCTTCCCCTGAATGCCAGTTGTGAAGGGCGGATAGCGACTGTCCGGACGATCACGATTAATAGGCAGACTCTGTTCAATTCGCAGAGGGGGATCTTTTTGGATGATTGTCGTCGGTGCGACTGTCCAAACCCGCGCCGTGTGGCGATGCGAGGCGACTACAATATGAGGCAACAGGGACTTCGCTTCCGGTATACGCATGGTACACATCCCGACTTCTCGCAGCTTCGGTACACATCGATCTGGGCGGTAGCTCCTACGGGCATCTCCTAGTAGGCAATGATCGCGATCGAGAACTGGTAACACAATATCCCAGTGTTGCTTCGTAGCCAAGTTCAATGCTATAGAGATTGTTAAACCACGGGGTTGCAATCCATTCTGGACGGTATCCTGAGTAACCTTAACTGTTTTGACTGTACCCAGTGTGAGCGTAGGGAAATCATTTTGGATCCTACGGGCGGGAGGCCGAATAGGGGTCTAGTATTGTGTGCGTGCCTGGAGCTTGCCGCCCACATCAATAGCTAGCTGTTCTCCCGAGCGAACTCGCCACTGAGGAACGACGGATGATGGGTACTGGATAGGCGTTTACATTTTCAAACGCACAAACCGGGACCATTCGCCTGAAGTCCGACAGGGTGGTGGGTTCATTGCACTCGGCGCATTTAAACTGCCCTCACCATGCTCTCGGATACTATAAATAGAGCATCGGCCCGAAGGTTTCCGACTTCGCAGGCACCCGACCAATATACACCAGAATTGCTCCTGTTGACCTTTGTATTTCTGATATAGTTCTTAAAAATGGCAGTTCTGATCCAGGGAATCCTCTTTCTGGAATAAACAGCCCCGGGGTCGAAATTTCGGTCGACCTCGCCAATTAGCCCTAGCTCGGTTTGACAGGGTCTGACATATAGTGCGTCCAGCTTCCGTATCGACCTTTTACGAATAATGGCTATCCTGGAGACAATAAATCAACTTATGACCCCTTACTGCCTAGCACCCAGAGGACTCAAAGAATCAGATACAGCGAGGGCAACCTATACCACAAACTGCCCAATATGCGTGGCCTCAGCTTGACCAAACTCTAGCACAGCAAAGTTCCTGCGCTTCCGAAGGCGGCATGCATACCGGAGTTATCCTTGTCGGTTATTACTTACCCCGTTCGCTCGTGAACAGTTCGGAGGGTCTCCTCCGGCCCCGGCGTATTATCACCGGTGTGTCGGTTATTGACGTTTCTTGTCGGTTATTAGTCCAGCGGCAGTGTCGGTTATTTTGGGTGTCGGTTATTGACACGGTGTCGGTTATTAAGCACCTCGTCTGTCGGTTATTTATTTGGTATATGAGTACACAGTTGTCTGTCGGTTATTATAATGTCGGTTATTGCCGCGCAATATAGCAAGTCTGGCGCCGATGTCGGTTATTTTCACTACGGGTGTCGGTTATTATAAACTGTCGGTTATTCTGAATTGTCGGTTATTTCTGTCGGTTATTTTGTCGGTTATTTTTTGATATCTCTGTCGGTTATTCAGGTAACATTGGTGTCGGTTATTGGTGTCGTGTCGGTTATTCGTTCCCATCTGCTGTGTCATGTCGGTTATTATTGTCGGTTATTAGCGTGTCGGTTATTAGCCTGACAATTTGTCGGTTATTCTTGTCGGTTATGTCGGTTATTTGCTGCTCCTGATTGATTCTCGGCTTCGTTTCTTGCGGGCGTTACATGTCGGTTATTACCTTACGCGGATAGCGATCCTAACATCCTGAAACGACCCGTGCTGAATCTCATCGCACGCCAGCGGGTTACAATGTAGCTCTCTCTTATTTGGTGCCACCGAAAGTCATGACCCACGTCGTCGGATCCGGCCGTTAGACCGTATCATGAAGATTCAGAACTTAGCAATTCGATCGTATCGTGATTATGCGACCAACCAGCGTTTGCGAGGCCCCGCCGGCCTGAAGATGTCCATACTCCGATATCGCTGGAACCTGCCATAGTTATCCCGGATGACTGCTTGGGGCAGGCAAGCTCATGACCACGGCCGGACCGGCCCCTCAGACATGAGTAAAAAGCCGGCACTGTAGAATAACCTCACAACTCTGCGGGCCTACTCCGCGAAAAATAAGCTTACGCTACCTAGAAAACAACTTGACAGTTGATGCCCGAAATGTCCATCTAATCGATGTGGGTCCATGCGCCACCTCCAGTCCGGTTGAAATAAATGCCTTCCGCCAACTCAGGGTACGTCTTCCGTTTAAACTGGACCTCGGCAAAAAAAAACGCTTCAATCAAGCAGTTTTGTACGGCGGCATGATCTATTCTTTCGCCCTCCCGTCCGATTAGGTCGAGAGACATATGGTCAGAGAGAACCAGGTGGTGCAAAGGAGTCGTGATCGTGCAGAGCTTACGGTGGGAGTTATATTAGTCCGTGCAACGCTTCCATATCTAATTGTGAGTTCTCGTCCGGATTAGAGAACCACGCAAGAAATTAGTCGTGGCAACTTTAAGACCGATGGATACACCACAGGGACGTATTCGCATAGGCTGTGCTATCCAATCCCCGTGGCATGTAACTGTTTTGAGTAGATGTGCCCTTTTAAGACGAGAGATGGGTCATTGACGTCTCTATTACCCTTTCTCGGTATGGGCTGGGCACTCTGAAATCAGCATATAGGTGCGAGGGGCATAGTACATTAAATCAATAAGGAAGTATATGAATCTCCTGAGCTGCTAACTAGAGTAGAGTAACTAGAGCTGCTAACTAGAGAAAGACCAAACCACGCGGTATTGCTAACTAGAGGGCTAACGCTAACTAGAGTGACCGACGACTACATTTCGGAGAGCTAACTAGAGTACGAGAGAACTGCTAACTATCATCGACTATCATCGTAGAGTTCTATCATCGGGCTAACTAGAGGAACCTATCATCGTAACTAGCTATCATCCTATCATCGATCGAAGAAGCAGAATGCCGGAACCAAGCCCTATCATCGTCTATCATCGTCTCTCTATCATCGCGTTGAAAGCTAACTAGAGCGATCTAACAAGGTGTAACGTCTTCCCGTCTGACTATCATCGAACTAGAGCTAGAGCTTCGGCCGAAGTCGTTAGGCTCTGCTCACTCTATCGCCGCTCACTCGCTCACTCGCTCACTCTATGCTCACTCTAATCGCGCTATCGCTCACTCTACGTTGGCTATCATCGATCATCGTCTATCATGCTCACTCTAAGAGATCGACCAGCTCACTCTATCATCGTGCTCACTCTATGATGCCTAGCTCACTCTATCATCGCCGCATGCCTAATGCGGATGCGGTTTGCTCACTCTATCATCGACCTATCATCGCTGGGAGATCTCCATACTATCATCGGCACGCTCACTCTATCTAGCTCACTCTATCGCGCTCACTCTATGCTCACTCTACTCTATACCGCTCACTCTACTGCTCACTCTAAAGCTCACTCTAGCGGCGCTCACTCTACTCACTCTATCGATGCTCACTCTACACTCTACGTTTCCACGTTATGTCCAGACTGCTCACTCTACCGACTTGTATAGTGGCTCCAGGCATCCAGACTACTAGCTCACTCTATATGCGTGGGTTTGTACGGGTTTGTACATGGCGGGGCTCACTCTAGTAGCTCACTGCTCACTCTACTAGACTTCGTCCAGACTGATTGAGCGTCGCCTAAGTCCAGACTTCCAGACTCGTCCAGACTCTCGCGGGCTCGCCCCTGACTACCTGGGGTTTGTAGACTAACGGGGCCTCCAGTCCAGACTACTAGGACCTATCCAGATCCAGACTCCCTTATAATCCAGACTTGAGGGGGTTTGTAGTTTGTAGCTCCTTACACAGTATGGGTTTGTAGGTTTGTAGGGTTTGTAGAGGGTTTGTAGGGGGTTTGTATTCTTAGGGTTTGTAGGGGTTTGTATACCGTTCCAGACTGAGGGTTTGTATTTGTACGGTTCACGGCTAGGGTTTGTACTTTCGATATTCGTCGGGTTTGTATTCGACATCTTCGGAGCTGCGTCAAGGGGGGTTTGTATGTGGGTTTGTATCTCTCCTAGTTGAACATCCCGCTTTATCTCCGCCGGGTTTGTACGCCCTGGGTTTGTATTGTGGGTTTGTACGGCACCATAAACGGGTTTGTATATAAACGGCACTGTTGAAACCTAAACGGCACGGCACTAGTGCGTTTGAGTTGTGTAAACGGACATTCCCAGACTTAAACGGCACACCACTGTTTAAACGGTAAACGGCACGCCCCGGTTACGTTCGACTCAATAACAAGGGGGAATAAACGGCACAAACGGCACCACTTATTACGCGAACTAAACGGCACGTGAGTCTTGGAGGTAAACGGCACACTACATCCGCATTAAACGGCACTATGGGCAGTTAAGCTAAACGGCACTCGCGTACGGCACATTGATAAACGGCACCCGAGCAAGGAATGGTGAATTTGTCCACCGAGGCACTCGTTCCATTTAAATTTGCAGCGGACGTTTTGCAGCGGAAACGGCACCGGTTTTTTGCAGCGGACACCCCTTGGCAGAGGTAAACGGCATTTGTTTGCAGCGGTTGCAGCGGAACGGCACATTTGCAGCGGAAACGTTTGCAGCGTTTGCAGCGGTTGCAGCGGAGCGGTTGATGTCGATTGTTGCCCTTTGCAGCGGTTTGCAGCGGATCTTTGCAGCGGGTAGGCCATCGTGTCTTTGCAGCGGGGGTATGTTTTGCAGCGGGTTTGCAGTTTGCAGCGGAAATACCACGGATATAGATTTTGCAGCGGCGTTTGCAGCGGCGATTTGCAGCGGCTTTTGCAGCGGGTTTGCAGCGGCTCAGTTTTTAAAAAATTTTTTGCAGCGGGGTGTGAGCCCCGATCGTTGACGCGAGTGTTTGCAGCGGACAGGTATTTCGGAACCGTTTGCAGCGGGGCTGATGGTTTTGCAGCGGCAACGTTGCGAGAAGTTTGCAGCGGCGAGCGCGTCTTTGCTGAAGAAACGACTCGCCCCCGCCCCCGTTACGTTCTTTTTTACTACGAAACGTTCCGCTATGGCTGCATGATTAACCGGCAGGCCCTTCGGCGCGAGAGAATTGTTAAGTTGAATGACACATTTATATGGAAGCCGGGGTCGCATCTGACTCTTTCTAGTAAATCTATCTGTAGCCCGCTCCCCAGGAGTTCCTAGGGTTGCACGGAGCGGCGGATCAGTCACCGACGAGAGTATCGCCGTTCAGAAGTTTAGTCGAAAAGGCGTTAAGTTCAACCGAATGAATAACCCGCGCGCAGGCTCGTTTAATTGCATTACTCGAAGGATGGTTGGACACTTGATGCCTATACGACAGAAAGTACCGAGGACCTTGAACGTTCTTTCAGAGCCGCGCGGGGTCTGCGAAATGCTTTACGGCCAGATGGAGGAGGCCCTACAGCCGCGATACAAAACGCGGGATTCCTACGAAACCTGAATACCAGGCGCCAGATTCTTGAAGTACATGGAACTGCGTATGATCGTGGATCAAAGTCACCTGCGTATGACTAGAGTGCCTCTGCGTATGAATGCGACGGCTTTATTTTAGGGCTGCGTATGAGTACTGCGTATGAACGTATGAAGTGATTCTGCCTGCGTATGAGTCTGCGTATGAACGGAGCCTAGTTATCGTTTCCTAGACTCGGCGACGGGGGACCTTTATAGATAGGACAGACAGGAAGCTTTGCTGCGTATGACTTTGTCGCTTTGTCGCTTTGTCGCTTTGTCGCTTTGTCGCTTTGTCCTGCTGCGTATGACGCTTCTGCGTATGATGCGTATGACTTTGTCGCTGCGTATGAATCCTGCGTATGCTGCGTATGATCCTGCGTATGATTGCTGCGTATGACTGCGTATGATGTTTGAAGTTTAGCGTATGATTGAAGTTTAGCTAGCCGTTGAAGTTTAGCCTGTGAAGTTTAGCCTTTGTCGCTTTGTCGCTTTGAAGTTTAGCCGTTTCCTGCGTATGAGTGAAGTTTAGCAGTTTAGCTGATTTCCTGAAGTTTAGCCAAGTTTCCGCAAGTTTTGTGAAGTTTAGCCAAGTTTCCGCAAGTCTGAAGTTTAGCCGCAAGTGAAGTTTAGCTTCCGCAAGTTTCCGCAAGTTTCCGCAAGTTTCCGCAAGTTTGAAGTTTAGCTTTAGCGTTTCCGCAAGTTTCCGCAAGTTTCCGCAAGTTTTGAAGTTTAGCAGTTTTGAAGTTTAGCAGTTTAGCAGTTTCCGCAAGTGTGAAGTTTAGCCCTGAAGTTTAGCCAAGTTTCCGCAAGGCACGATCATTCCGCAAGTTTCTGAAGTTTAGCTGTGAAGTTTGAAGTTTAGCACGATCACACGATGAAGTTGAAGTTTAGCAGCACGAGCACGATCAATATTTGAAGTGAAGTTGAAGTTTAGCAATATTGACCAATATGCACGATCAGACCAATATTGGCACGATCACCAATATTGACCTGAAGTTTAGCATTGGCACGATCACCAATATTGACCAATATTGACCAGCACGATCAATCACCAATATTGACCAATATGCACGATCAGACCAATAGCACGATCATGACCAATAGCACGATCAACCAATATTGCACGATCAAGCACGATCACAATATTGACCAATATTGACGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCACGATCAGCGCACGATCAGATCAGCACGATCA'
    print find_clumps(10*S, 11, 544, 18)
